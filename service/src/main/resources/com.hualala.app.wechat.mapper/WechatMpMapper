<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hualala.app.wechat.mapper.WechatMpMapper">

    <select id="queryByParams" resultType="java.util.Map" parameterType="java.util.Map">
        SELECT
        itemID,
        mpID,
        ghID,
        mpName,
        mpType,
        token,
        appID,
        groupID,
        brandID,
        appSecret,
        encodingAESKey,
        weixinURL,
        headImg,
        qrCodeURL,
        menuJson,
        shopID,
        customerWithoutBindMobile,
        subscribeToCcustomer,
        tableMsgTemplate,
        funcInfo,
        alias,
        authorize,
        authorizerRefreshToken,
        oauth,
        isActiveUse,
        wechatEndDate
        FROM
        tbl_shop_wechat_mp
        <include refid="setParametre"/>
        ORDER BY
        actionTime DESC
        <if test="pageOffset != null and pageSize != null">
            LIMIT #{pageOffset}, #{pageSize}
        </if>
    </select>

    <!-- 条件查询sql -->
    <sql id="setParametre">
        <trim prefix="WHERE" prefixOverrides="AND|OR">
            action in (0,1)
            <if test=" mpID != null and mpID!='' ">
                AND	mpID = #{mpID}
            </if>
            <if test=" groupID != null and groupID!='' ">
                <!-- AND	groupID = #{groupID}	 -->
                <choose>
                    <when test="groupID == 205">
                        AND groupID in (0,205)
                    </when>
                    <otherwise>
                        AND groupID = #{groupID}
                    </otherwise>
                </choose>
            </if>
            <if test=" itemID != null and itemID !='' ">
                AND	itemID = #{itemID}
            </if>
            <if test=" isActiveUse != null and isActiveUse !='' ">
                AND	isActiveUse = #{isActiveUse}
            </if>
            <if test="appID !=null and appID != '' ">
                AND appID = #{appID}
            </if>
            <if test="isMpType!=null">
                AND mpType IN (11,21)
            </if>
            <if test="isAuthorize != null">
                AND authorize in (0,1)
            </if>
        </trim>
    </sql>

    <sql id="SQL_Params">
       itemID, mpID, ghID, mpName, mpType, token, appID, groupID, brandID, appSecret, encodingAESKey, weixinURL, headImg,
       qrCodeURL, menuJson, shopID, customerWithoutBindMobile, subscribeToCcustomer, tableMsgTemplate, funcInfo, alias,
       authorize, authorizerRefreshToken, oauth, isActiveUse, wechatEndDate
    </sql>
</mapper>
